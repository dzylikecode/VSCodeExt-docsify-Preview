<!--injected by docsify preivew-->
<script>
  window.onbeforeunload = function (e) {
    localStorage.setItem("scrollpos", document.scrollingElement.scrollTop);
  };
  // window.onload = () => {
  //   let scrollpos = localStorage.getItem("scrollpos") ?? 0;
  //   let curPos = +scrollpos;
  //   window.scroll(0, 300);
  // };
  document.addEventListener("DOMContentLoaded", function (event) {
    let scrollpos = localStorage.getItem("scrollpos") ?? 0;
    let curPos = +scrollpos;
    // window.scrollTo(0, curPos);
    setTimeout(function () {
      window.scrollTo(0, curPos);
    }, 50);
  });
  const websocket = new WebSocket("ws://" + document.location.host);
  // websocket.onopen = () => {
  //   console.log("connected");
  //   let scrollpos = localStorage.getItem("scrollpos") ?? 0;
  //   let message = JSON.stringify({
  //     command: "requsetScroll",
  //   });
  //   websocket.send(message);
  // };
  websocket.onmessage = (event) => {
    let message = JSON.parse(event.data);
    switch (message.command) {
      case "scroll":
        updateScroll(+message.linePercent);
        break;
      case "reload":
        reloadWindow();
        break;
    }
  };

  function updateScroll(linePercent) {
    const nextPosition = document.body.scrollHeight * linePercent;
    window.scroll(0, Math.ceil(nextPosition));
  }
  function reloadWindow() {
    document.location.reload();
  }
</script>
